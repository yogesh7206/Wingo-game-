<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Win89 Merged Dashboard</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; background: #f8f9fa; }
header { background: #007bff; padding: 10px; color: #fff; text-align: center; font-size: 20px; font-weight: bold; }
nav { background: #fff; border-top: 1px solid #ccc; position: fixed; bottom: 0; left: 0; width: 100%; display: flex; justify-content: space-around; padding: 5px 0; z-index: 1000;}
nav button { background: none; border: none; font-size: 14px; color: #333; display:flex; flex-direction:column; align-items:center; }
nav button span { font-size:18px; }
.section { display: none; padding: 15px; }
.active-section { display: block !important; }
.account-stats { display: flex; justify-content: space-around; flex-wrap: wrap; background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 15px; }
.stat { text-align: center; flex: 1 1 45%; margin: 5px 0; }
.stat h3 { color: #004085; margin: 0; font-size: 18px; }
.stat p { color: #6c757d; font-size: 14px; margin: 0; }
.action-buttons { display: flex; justify-content: space-around; margin-top: 10px; }
.action-buttons button { flex: 1; margin: 5px; padding: 12px; border: none; border-radius: 25px; font-size: 16px; color: #fff; }
.recharge-btn { background: linear-gradient(45deg, #ffc107, #ffb300); }
.withdraw-btn { background: linear-gradient(45deg, #28a745, #218838); }
.menu-list{margin:15px 0;background:#fff;border-radius:12px;overflow:hidden}
.menu-item{display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid #eceff1; cursor:pointer;}
.menu-item:last-child{border-bottom:none}
.menu-item.active,.menu-item:hover{background:#e9f1fc;}
.menu-icon{font-size:20px;width:24px;text-align:center}
.menu-text{flex:1;font-size:15px;color:#212529}
.menu-arrow{color:#9aa0a6}
.profile-avatar {width:68px; height:68px; border-radius:50%; object-fit:cover;}
.user-info-top {background:#f6f6f8; border-radius:16px; display:flex; align-items:center; gap:18px; padding:18px 14px 16px 14px; margin-bottom:15px;}
.user-contact {font-size:18px; font-weight:bold; color:#111; margin-bottom:6px;}
.invite-code-box { background:#fff;font-size:16px;padding:4px 14px; border-radius:12px;display:inline-block;letter-spacing:1.2px; color:#157efb; font-weight:500; border:1px solid #e0e6ed;}
.copy-icon {cursor:pointer; font-size:19px; margin-left:5px;}
.logout-btn-big {
    display: block;
    width: 94%;
    margin: 28px auto 18px auto;
    padding: 18px 0;
    font-size: 20px;
    font-weight: bold;
    border: none;
    border-radius: 18px;
    background: linear-gradient(90deg, #157efb 0%, #4bb2ff 100%);
    color: #fff;
    box-shadow: 0 1px 7px #1561c340;
    transition: background 0.2s;
    cursor: pointer;
}
.logout-btn-big:hover {
    background: linear-gradient(90deg, #1561c3 0%, #2891ec 100%);
}
.page-content{max-width:440px;margin:35px auto;padding:23px 16px 24px 16px;background:#fff;border-radius:16px;box-shadow:0 1px 8px #ddeaff;}
.page-content h2{margin-top:0;}
.page-content label{font-weight:bold;margin-top:12px;display:block;}
.page-content input, .page-content select {width:100%;margin:6px 0 18px 0; padding:8px; border-radius:6px; border:1px solid #ccc;}
.page-content button, .page-content .btn {padding:10px 18px;background:#157efb;color:#fff;border:none;border-radius:7px;font-size:16px; font-weight:bold;}
.page-content table{width:100%;border-collapse:collapse;}
.page-content th, .page-content td{border:1px solid #eee;padding:8px;}
.page-content th{background:#157efb;color:#fff;}
.page-content td{background:#f8fafd;}
</style>
</head>
<body>

<header>Win89</header>

<!-- Navigation: always shows -->
<nav id="bottomNav">
    <button onclick="showSection('homeSection')"><span>üè†</span>Home</button>
    <button onclick="showSection('investmentSection')"><span>üí∞</span>Investment</button>
    <button onclick="showSection('blogSection')"><span>üìù</span>Blog</button>
    <button onclick="showSection('noticeSection')"><span>üì¢</span>Notice</button>
    <button onclick="showSection('accountSection')"><span>üë§</span>Account</button>
</nav>

<!-- Dashboard MAIN Sections -->
<div id="loginSection" class="section active-section">
    <h2>Login</h2>
    <input type="email" id="loginEmail" placeholder="Email"><br><br>
    <input type="password" id="loginPassword" placeholder="Password"><br><br>
    <button onclick="loginUser()">Login</button>
    <p>Don't have an account? <a href="#" onclick="showSection('registerSection')">Register</a></p>
</div>

<div id="registerSection" class="section">
    <h2>Register</h2>
    <input type="email" id="registerEmail" placeholder="Email"><br><br>
    <input type="password" id="registerPassword" placeholder="Password"><br><br>
    <button onclick="registerUser()">Register</button>
    <p>Already have an account? <a href="#" onclick="showSection('loginSection')">Login</a></p>
</div>

<div id="homeSection" class="section">
    <h2>Home</h2>
    <p>Welcome to Win89!</p>
</div>

<div id="investmentSection" class="section">
    <h2>Investment</h2>
    <p>Your investments appear here.</p>
</div>

<div id="blogSection" class="section">
    <h2>Blog</h2>
    <p>Latest blog posts.</p>
</div>

<div id="noticeSection" class="section">
    <h2>Notice</h2>
    <p>Important updates.</p>
</div>

<!-- ACCOUNT DASHBOARD (default page) -->
<div id="accountSection" class="section">
    <h2>My Account</h2>
    
    <!-- User info panel -->
    <div class="user-info-top">
        <img id="userAvatar" class="profile-avatar" src="https://ui-avatars.com/api/?name=User&rounded=true&background=4bb2ff&color=fff&size=96" alt="avatar">
        <div style="flex:1;">
            <div id="userContact" class="user-contact">MOBILE: -</div>
            <div style="display:flex;align-items:center;gap:7px;">
                <span class="invite-code-box">
                    Invite Code: <span id="inviteCode">------</span>
                </span>
                <span class="copy-icon" title="Copy" onclick="copyInviteCode()">üìã</span>
            </div>
        </div>
    </div>
    <!-- END User info panel -->

    <div class="account-stats">
        <div class="stat">
            <h3 id="balance">‚Çπ0</h3>
            <p>Balance</p>
        </div>
        <div class="stat">
            <h3 id="recharge">‚Çπ0</h3>
            <p>Recharge</p>
        </div>
        <div class="stat">
            <h3 id="withdrawal">‚Çπ0</h3>
            <p>Withdrawal</p>
        </div>
        <div class="stat">
            <h3 id="productRevenue">‚Çπ0</h3>
            <p>Product revenue</p>
        </div>
        <div class="stat">
            <h3 id="myOrders">0</h3>
            <p>My Orders</p>
        </div>
    </div>
    <div class="action-buttons">
        <button class="recharge-btn">Recharge</button>
        <button class="withdraw-btn">Withdrawal</button>
    </div>
    <br>
    <!-- Submenus -->
    <div class="menu-list" id="submenuList"></div>
    <button class="logout-btn-big" onclick="logoutUser();">Logout</button>
</div>

<!-- Merged submenu FULL PAGES - Only one shown at a time -->
<div id="bankCardPage" class="section">
  <div class="page-content">
    <h2>Bank Card Details</h2>
    <form>
      <label>Card Number</label>
      <input type="text" placeholder="Enter card number" required>
      <label>Bank Name</label>
      <input type="text" placeholder="Enter bank name" required>
      <label>IFSC Code</label>
      <input type="text" placeholder="Enter IFSC code">
      <button type="submit">Save Card</button>
    </form>
  </div>
</div>
<div id="transactionsPage" class="section">
  <div class="page-content">
    <h2>Recent Transactions</h2>
    <table>
      <tr><th>Date</th><th>Type</th><th>Amount</th><th>Status</th></tr>
      <tr><td>2025-08-10</td><td>Deposit</td><td>‚Çπ500</td><td>Success</td></tr>
      <tr><td>2025-08-12</td><td>Withdrawal</td><td>‚Çπ300</td><td>Pending</td></tr>
    </table>
  </div>
</div>
<div id="myProductPage" class="section">
  <div class="page-content">
    <h2>My Products</h2>
    <div class="product">Product A <button class="btn">View</button></div>
    <div class="product">Product B <button class="btn">View</button></div>
  </div>
</div>
<div id="myTeamPage" class="section">
  <div class="page-content">
    <h2>My Team</h2>
    <button class="btn">Invite New Member</button>
    <ul>
      <li>Team Member 1</li>
      <li>Team Member 2</li>
    </ul>
  </div>
</div>
<div id="customerServicePage" class="section">
  <div class="page-content">
    <h2>Customer Service</h2>
    <p>Contact us at <b>support@win89.com</b></p>
    <button class="btn" onclick="window.open('https://t.me/YourTelegramGroupLink','_blank')">Open Telegram</button>
  </div>
</div>
<div id="resetPasswordPage" class="section">
  <div class="page-content">
    <h2>Reset Password</h2>
    <form>
      <label>Old Password</label>
      <input type="password" placeholder="Enter old password" required>
      <label>New Password</label>
      <input type="password" placeholder="Enter new password" required>
      <button type="submit">Reset Password</button>
    </form>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDvF1KrDDRZJucp-78dbvmQ34Oi3j17Rrk",
  authDomain: "investment-website-deml.firebaseapp.com",
  projectId: "investment-website-deml",
  storageBucket: "investment-website-deml.firebasestorage.app",
  messagingSenderId: "814451995593",
  appId: "1:814451995593:web:55e3280d9cb43200f1ee18",
  measurementId: "G-8FKZE5NNSX"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
</script>

<script>
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active-section'));
  var el = document.getElementById(id);
  if(el) el.classList.add('active-section');
}

// Invite code copy
function copyInviteCode() {
    var code = document.getElementById('inviteCode').innerText;
    navigator.clipboard.writeText(code);
    alert('Invite code copied!');
}

// Account information
auth.onAuthStateChanged(async (user) => {
  const nav = document.getElementById('bottomNav');
  if (!user) {
    nav.style.display = 'none';
    showSection('loginSection');
    return;
  }
  nav.style.display = 'flex';
  showSection('homeSection');

  const UID = user.uid;
  const userRef = db.collection('users').doc(UID);
  const snap = await userRef.get();

  if (!snap.exists) {
    await userRef.set({
      inviteCode: 'xKed0R',
      balance:0, rechargeTotal:0, withdrawalTotal:0, productRevenue:0, orders:0,
      email: user.email,
      mobile: '917206343481'
    });
  } else {
    const data = snap.data();
    const updates = {};
    if (!data.inviteCode) updates.inviteCode = 'xKed0R';
    if (!data.email) updates.email = user.email;
    if (Object.keys(updates).length > 0) await userRef.update(updates);
  }

  userRef.onSnapshot(doc => {
    const d = doc.data() || {};
    document.getElementById('balance').textContent = '‚Çπ'+(d.balance||0);
    document.getElementById('recharge').textContent = '‚Çπ'+(d.rechargeTotal||0);
    document.getElementById('withdrawal').textContent = '‚Çπ'+(d.withdrawalTotal||0);
    document.getElementById('productRevenue').textContent = '‚Çπ'+(d.productRevenue||0);
    document.getElementById('myOrders').textContent = d.orders||0;
    document.getElementById('userContact').textContent = d.mobile 
        ? `MOBILE: ${d.mobile}` 
        : (d.email ? `EMAIL: ${d.email}` : '-');
    document.getElementById('inviteCode').textContent = d.inviteCode || '------';
    if(d.avatarUrl) document.getElementById('userAvatar').src = d.avatarUrl;
  });
});

async function loginUser(){
  const email = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPassword').value.trim();
  if(!email || !pass){ alert('Enter email & password'); return; }
  try{ await auth.signInWithEmailAndPassword(email, pass); }
  catch(e){ alert(e.message); if(e.code==='auth/user-not-found') showSection('registerSection'); }
}

async function registerUser(){
  const email = document.getElementById('registerEmail').value.trim();
  const pass = document.getElementById('registerPassword').value.trim();
  if(!email || !pass){ alert('Enter email & password'); return; }
  try{
    const cred = await auth.createUserWithEmailAndPassword(email, pass);
    await db.collection('users').doc(cred.user.uid).set({
      inviteCode: 'xKed0R',
      balance:0, rechargeTotal:0, withdrawalTotal:0, productRevenue:0, orders:0,
      email,
      mobile: ''
    });
    alert('Registered! Please login.');
    showSection('loginSection');
  }catch(e){ alert(e.message); }
}

function logoutUser(){ auth.signOut(); }

// Submenu logic: switch to full page content
(function(){
  const menuData = [
    { id:"bankCardPage", icon:"üè¶", text:"Bank Card" },
    { id:"transactionsPage", icon:"üßæ", text:"Transactions" },
    { id:"myProductPage", icon:"üì¶", text:"My Product" },
    { id:"myTeamPage", icon:"üë•", text:"My Team" },
    { id:"customerServicePage", icon:"üí¨", text:"Customer Service" },
    { id:null, icon:"üì¢", text:"Telegram Group", url:"https://t.me/YourTelegramGroupLink" },
    { id:"resetPasswordPage", icon:"üîí", text:"Reset Password" }
  ];
  const wrap = document.getElementById('submenuList');
  wrap.innerHTML = menuData.map(item =>
    `<div class="menu-item" tabindex="0">
      <span class="menu-icon">${item.icon}</span>
      <span class="menu-text">${item.text}</span>
      <span class="menu-arrow">‚Ä∫</span>
    </div>`
  ).join('');
  Array.from(wrap.querySelectorAll('.menu-item')).forEach((item, i) => {
    item.onclick = function() {
      if(menuData[i].url) {
        window.open(menuData[i].url, "_blank");
      } else if(menuData[i].id) {
        showSection(menuData[i].id);
      }
    }
  });
})();
</script>
</body>
</html>
