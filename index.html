<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wingo Game</title>
  <style>
    body {
      font-family: Arial;
      text-align: center;
      background: #eaf1ff;
      padding: 20px;
    }
    input, button, select {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .hidden { display: none; }
    .red { background: #e53935; color: white; }
    .green { background: #43a047; color: white; }
    .violet { background: #8e24aa; color: white; }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background: #0055ff;
      color: white;
    }
    #gameSection {
      max-width: 600px;
      margin: auto;
    }
  </style>
</head>
<body>  <div id="gameSection">
    <h1>Welcome, <span id="userEmail"></span>!</h1>
    <p>Balance: ₹<span id="wallet">0</span></p>
    <p>Period: <span id="periodDisplay">--</span></p><div>
  <button class="red" onclick="selectColor('RED')">Red</button>
  <button class="green" onclick="selectColor('GREEN')">Green</button>
  <button class="violet" onclick="selectColor('VIOLET')">Violet</button>
</div><br>

<input type="number" id="bet" step="0.1" placeholder="Enter Bet ₹">
<button onclick="placeBet()">Place Bet</button>

<p id="result"></p>

<h3>Live Game History (Big/Small)</h3>
<table>
  <thead><tr><th>Number</th><th>Big/Small</th><th>Color</th></tr></thead>
  <tbody id="historyTable"></tbody>
</table>

<h3>Your Bet History</h3>
<table>
  <thead><tr><th>Period</th><th>Color</th><th>Bet ₹</th><th>Result</th></tr></thead>
  <tbody id="yourBetTable"></tbody>
</table>

  </div>  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
    import { getDatabase, ref, set, get, update, onValue, push } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";

    const app = initializeApp({
      apiKey: "AIzaSy...",
      authDomain: "...",
      databaseURL: "...",
      projectId: "...",
      storageBucket: "...",
      messagingSenderId: "...",
      appId: "..."
    });

    const auth = getAuth(app);
    const db = getDatabase(app);
    let currentUser = null;
    let currentBalance = 100;
    let selectedColor = null;
    let confirmedBet = null;
    let currentPeriod = "";

    function getResultColor(num) {
      if (num === 5) return "VIOLET";
      else if ([1, 3, 7, 9, 0].includes(num)) return "RED";
      else return "GREEN";
    }

    function updateHistory() {
      onValue(ref(db, "results/30"), (snap) => {
        const data = snap.val();
        const rows = [];
        const keys = data ? Object.keys(data).sort().reverse().slice(0, 10) : [];
        for (const key of keys) {
          const val = data[key];
          const bigSmall = val.number >= 5 ? "Big" : "Small";
          const emoji = val.color === "RED" ? "🔴" : val.color === "GREEN" ? "🟢" : "🟣";
          rows.push(`<tr><td>${val.number}</td><td>${bigSmall}</td><td>${emoji}</td></tr>`);
        }
        document.getElementById("historyTable").innerHTML = rows.join("");
      });
    }

    function loadYourBets() {
      if (!currentUser) return;
      onValue(ref(db, `bets/${currentUser.uid}`), (snap) => {
        const data = snap.val();
        const rows = [];
        const keys = data ? Object.keys(data).sort().reverse().slice(0, 10) : [];
        for (const key of keys) {
          const bet = data[key];
          rows.push(`<tr><td>${bet.period}</td><td>${bet.color}</td><td>₹${bet.amount}</td><td>${bet.result}</td></tr>`);
        }
        document.getElementById("yourBetTable").innerHTML = rows.join("");
      });
    }

    function placeBet() {
      if (!selectedColor) return alert("Select a color");
      const amount = parseFloat(document.getElementById("bet").value);
      if (!amount || amount <= 0) return alert("Enter valid bet");

      const number = Math.floor(Math.random() * 10);
      const resultColor = getResultColor(number);
      const win = resultColor === selectedColor;
      const periodId = new Date().toISOString().slice(0, 19);

      // Save result
      set(ref(db, `results/30/${periodId}`), {
        number,
        color: resultColor,
        timestamp: Date.now()
      });

      // Save personal bet
      push(ref(db, `bets/${currentUser.uid}`), {
        period: periodId,
        color: selectedColor,
        amount,
        result: win ? "Win" : "Lose"
      });

      document.getElementById("result").innerText = win ? `✅ You Win! ${resultColor}` : `❌ You Lose! ${resultColor}`;
      updateHistory();
      loadYourBets();
    }

    window.selectColor = (c) => selectedColor = c;

    onAuthStateChanged(auth, user => {
      if (user) {
        currentUser = user;
        document.getElementById("userEmail").innerText = user.email;
        document.getElementById("wallet").innerText = currentBalance.toFixed(2);
        updateHistory();
        loadYourBets();
      }
    });
  </script></body>
</html>
