<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Investment Website</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  :root{
    --brand:#2196F3;
    --bg:#f5f7fb;
    --card:#ffffff;
    --text:#222;
    --muted:#666;
    --border:#e6e8ef;
    --success:#23c55e;
    --danger:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
  header{position:sticky;top:0;background:var(--brand);color:#fff;padding:12px 16px;z-index:5}
  header h1{margin:0;font-size:18px}
  header .wallet{font-size:14px;opacity:.95}
  main{padding:16px 16px 84px}

  /* Sections */
  .section{display:none}
  .section.active{display:block}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;margin:12px 0;box-shadow:0 1px 2px rgba(0,0,0,.04)}

  /* Buttons / inputs */
  .btn{display:inline-block;background:var(--brand);color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:600;cursor:pointer}
  .btn.secondary{background:#0ea5e9}
  .btn.ghost{background:#fff;color:var(--text);border:1px solid var(--border)}
  .btn.success{background:var(--success)}
  .btn.danger{background:var(--danger)}
  .btn.block{width:100%}
  input,textarea{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;background:#fff}
  label{font-size:13px;color:var(--muted)}

  /* Bottom nav */
  nav.bottom{position:fixed;left:0;right:0;bottom:0;background:#111;color:#fff;border-top:1px solid #222;display:flex;z-index:10}
  nav.bottom a{flex:1;text-align:center;text-decoration:none;color:#fff;padding:8px 0}
  nav.bottom a div{font-size:20px;line-height:20px}
  nav.bottom a small{display:block;font-size:12px;opacity:.9}
  nav.bottom a.active{background:#1e293b}

  /* Account submenu (like your screenshot) */
  .submenu{background:#fff;border-top:1px solid var(--border);border-bottom:1px solid var(--border);border-radius:12px;overflow:hidden}
  .submenu-item{display:flex;align-items:center;gap:10px;padding:14px 12px;border-bottom:1px solid var(--border);cursor:pointer}
  .submenu-item:last-child{border-bottom:none}
  .submenu-item:hover{background:#f9fafb}
  .submenu-icon{font-size:20px}
  .submenu-label{flex:1;font-weight:700}
  .submenu-arrow{font-size:20px;color:#9aa3b2}

  /* Admin badge/button */
  .admin-btn{position:fixed;right:12px;top:12px;z-index:20}
  .muted{color:var(--muted);font-size:12px}

  /* Simple grid for quick actions */
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
</style>
</head>
<body>
  <header>
    <h1>Investment Website</h1>
    <div class="wallet">Wallet Balance: ‚Çπ<span id="wallet-balance">0.00</span></div>
  </header>

  <!-- Admin open button -->
  <button class="btn admin-btn" onclick="openAdmin()">Admin</button>

  <main>
    <!-- HOME -->
    <section id="home" class="section active">
      <div class="card">
        <h3 style="margin:0 0 8px">Welcome üëã</h3>
        <div class="muted">Quick actions</div>
        <div class="grid2" style="margin-top:10px">
          <button class="btn block" onclick="openDepositDialog()">Deposit</button>
          <button class="btn secondary block" onclick="openWithdrawDialog()">Withdraw</button>
        </div>
      </div>

      <div class="card">
        <h3 style="margin:0 0 8px">Recent Transactions</h3>
        <div id="home-transactions" class="muted">Loading‚Ä¶</div>
      </div>
    </section>

    <!-- INVEST -->
    <section id="invest" class="section">
      <div class="card">
        <h3 style="margin:0 0 8px">Invest</h3>
        <div class="muted">Plans coming soon.</div>
      </div>
    </section>

    <!-- BLOG -->
    <section id="blog" class="section">
      <div class="card"><h3 style="margin:0 0 8px">Blog</h3><div class="muted">Latest tips & updates.</div></div>
    </section>

    <!-- NOTICE -->
    <section id="notice" class="section">
      <div class="card"><h3 style="margin:0 0 8px">Notice</h3><div class="muted">Announcements will appear here.</div></div>
    </section>

    <!-- ACCOUNT -->
    <section id="account" class="section">
      <div class="card">
        <h3 style="margin:0 0 8px">My Account</h3>
        <div class="muted">Manage your details</div>
      </div>

      <!-- Submenu styled like your screenshot -->
      <div class="submenu">
        <div class="submenu-item" onclick="showAccountPane('bank')">
          <span class="submenu-icon">üí≥</span>
          <span class="submenu-label">Bank Card</span>
          <span class="submenu-arrow">‚Ä∫</span>
        </div>
        <div class="submenu-item" onclick="showAccountPane('transactions')">
          <span class="submenu-icon">üìú</span>
          <span class="submenu-label">Transaction</span>
          <span class="submenu-arrow">‚Ä∫</span>
        </div>
        <div class="submenu-item" onclick="showAccountPane('product')">
          <span class="submenu-icon">üì¶</span>
          <span class="submenu-label">My Product</span>
          <span class="submenu-arrow">‚Ä∫</span>
        </div>
        <div class="submenu-item" onclick="showAccountPane('service')">
          <span class="submenu-icon">üí¨</span>
          <span class="submenu-label">Customer Service</span>
          <span class="submenu-arrow">‚Ä∫</span>
        </div>
        <div class="submenu-item" onclick="showAccountPane('reset')">
          <span class="submenu-icon">üîí</span>
          <span class="submenu-label">Reset Password</span>
          <span class="submenu-arrow">‚Ä∫</span>
        </div>
      </div>

      <!-- Account sub-pages (inline panes) -->
      <div id="pane-bank" class="card" style="display:none">
        <h3 style="margin:0 0 10px">Bind Bank Card</h3>
        <label>Bank Name</label>
        <input id="bank-name" type="text" placeholder="Enter bank name" />
        <label>Account Holder Name</label>
        <input id="account-holder" type="text" placeholder="Enter account holder name" />
        <label>Account Number</label>
        <input id="account-number" type="text" placeholder="Enter account number" />
        <label>IFSC Code</label>
        <input id="ifsc-code" type="text" placeholder="Enter IFSC code" />
        <div class="grid2" style="margin-top:8px">
          <button class="btn block" onclick="saveBankCard()">Save</button>
          <button class="btn ghost block" onclick="closeAccountPanes()">Close</button>
        </div>
        <div id="bank-saved" class="muted" style="margin-top:8px"></div>
      </div>

      <div id="pane-transactions" class="card" style="display:none">
        <h3 style="margin:0 0 10px">Transactions</h3>
        <div id="transactions-list" class="muted">Loading‚Ä¶</div>
        <div style="margin-top:8px"><button class="btn ghost" onclick="closeAccountPanes()">Close</button></div>
      </div>

      <div id="pane-product" class="card" style="display:none">
        <h3 style="margin:0 0 10px">My Product</h3>
        <div class="muted">Your purchased products will appear here.</div>
        <div style="margin-top:8px"><button class="btn ghost" onclick="closeAccountPanes()">Close</button></div>
      </div>

      <div id="pane-service" class="card" style="display:none">
        <h3 style="margin:0 0 10px">Customer Service</h3>
        <textarea id="cs-message" placeholder="Write your message"></textarea>
        <div class="grid2">
          <button class="btn block" onclick="sendMessage()">Send</button>
          <button class="btn ghost block" onclick="closeAccountPanes()">Close</button>
        </div>
      </div>

      <div id="pane-reset" class="card" style="display:none">
        <h3 style="margin:0 0 10px">Reset Password</h3>
        <div class="muted" style="margin-bottom:8px">We‚Äôll email a reset link.</div>
        <input id="reset-email" type="email" placeholder="Enter your email" />
        <div class="grid2">
          <button class="btn block" onclick="resetPassword()">Send Reset Link</button>
          <button class="btn ghost block" onclick="closeAccountPanes()">Close</button>
        </div>
      </div>
    </section>

    <!-- ADMIN PANEL (hidden until opened) -->
    <section id="admin" class="section">
      <div class="card">
        <div class="grid2">
          <button class="btn ghost" onclick="showSection('home')">‚Üê Back</button>
          <div></div>
        </div>
        <h3 style="margin:10px 0">Admin Panel</h3>
        <div class="muted">Pending deposit & withdrawal requests</div>
      </div>

      <div class="card">
        <h4 style="margin:0 0 8px">Deposit Requests</h4>
        <div id="admin-deposits" class="muted">Loading‚Ä¶</div>
      </div>

      <div class="card">
        <h4 style="margin:0 0 8px">Withdrawal Requests</h4>
        <div id="admin-withdrawals" class="muted">Loading‚Ä¶</div>
      </div>
    </section>
  </main>

  <!-- Bottom Navigation -->
  <nav class="bottom">
    <a href="#" id="tab-home" class="active" onclick="return showSection(event,'home')">
      <div>üè†</div><small>Home</small>
    </a>
    <a href="#" onclick="return showSection(event,'invest')">
      <div>üíπ</div><small>Invest</small>
    </a>
    <a href="#" onclick="return showSection(event,'blog')">
      <div>üì∞</div><small>Blog</small>
    </a>
    <a href="#" onclick="return showSection(event,'notice')">
      <div>üì¢</div><small>Notice</small>
    </a>
    <a href="#" onclick="return showSection(event,'account')">
      <div>üë§</div><small>Account</small>
    </a>
  </nav>

  <!-- Firebase v8 SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script>
  /* =========================
     Firebase Initialization
     ========================= */
  const firebaseConfig = {
    apiKey: "AIzaSyDvF1KrDDRZJucp-78dbvmQ34Oi3j17Rrk",
    authDomain: "investment-website-deml.firebaseapp.com",
    projectId: "investment-website-deml",
    storageBucket: "investment-website-deml.firebasestorage.app",
    messagingSenderId: "814451995593",
    appId: "1:814451995593:web:55e3280d9cb43200f1ee18",
    measurementId: "G-8FKZE5NNSX"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  let UID = null;

  // Anonymous sign-in for demo
  auth.signInAnonymously().then(() => {
    UID = auth.currentUser.uid;
    ensureWallet();
    loadWallet();
    loadHomeTransactions();
    preloadBankCard();
  }).catch(err => alert(err.message));

  /* =========================
     UI Helpers
     ========================= */
  function $(id){ return document.getElementById(id); }

  function showSection(ev, id){
    if(ev) ev.preventDefault();
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav.bottom a').forEach(a => a.classList.remove('active'));
    $(id).classList.add('active');
    if(ev && ev.currentTarget) ev.currentTarget.classList.add('active');
    // special loads
    if(id==='account'){ /* could lazy-load something here */ }
  }

  function showAccountPane(key){
    closeAccountPanes();
    const paneId = 'pane-' + key;
    const el = $(paneId);
    if(el) el.style.display = 'block';
    if(key==='transactions') loadTransactions();
  }

  function closeAccountPanes(){
    ['bank','transactions','product','service','reset'].forEach(k=>{
      const el = $('pane-'+k); if(el) el.style.display='none';
    });
  }

  /* =========================
     Wallet
     ========================= */
  async function ensureWallet(){
    const doc = await db.collection('wallets').doc(UID).get();
    if(!doc.exists){ await db.collection('wallets').doc(UID).set({ balance: 0 }); }
  }
  async function loadWallet(){
    db.collection('wallets').doc(UID).onSnapshot(snap=>{
      const bal = (snap.data() && snap.data().balance) || 0;
      $('wallet-balance').textContent = Number(bal).toFixed(2);
    });
  }

  /* =========================
     Deposit / Withdraw (User)
     ========================= */
  function openDepositDialog(){
    const v = prompt('Enter deposit amount (‚Çπ):');
    const amt = parseFloat(v);
    if(isNaN(amt) || amt<=0) return;
    db.collection('depositRequests').add({
      userId: UID, amount: amt, status: 'pending',
      time: firebase.firestore.FieldValue.serverTimestamp()
    }).then(()=>{
      db.collection('transactions').add({
        userId: UID, amount: amt, type:'deposit_request',
        status:'pending', time: firebase.firestore.FieldValue.serverTimestamp()
      });
      alert('Deposit request submitted.');
    }).catch(e=>alert(e.message));
  }

  function openWithdrawDialog(){
    const v = prompt('Enter withdraw amount (‚Çπ):');
    const amt = parseFloat(v);
    if(isNaN(amt) || amt<=0) return;
    db.collection('withdrawRequests').add({
      userId: UID, amount: amt, status: 'pending',
      time: firebase.firestore.FieldValue.serverTimestamp()
    }).then(()=>{
      db.collection('transactions').add({
        userId: UID, amount: -amt, type:'withdraw_request',
        status:'pending', time: firebase.firestore.FieldValue.serverTimestamp()
      });
      alert('Withdrawal request submitted.');
    }).catch(e=>alert(e.message));
  }

  /* =========================
     Bank Card
     ========================= */
  async function preloadBankCard(){
    const doc = await db.collection('bankCards').doc(UID).get();
    if(doc.exists){
      const d = doc.data();
      if($('bank-name')) $('bank-name').value = d.bankName || '';
      if($('account-holder')) $('account-holder').value = d.holder || '';
      if($('account-number')) $('account-number').value = d.accNumber || '';
      if($('ifsc-code')) $('ifsc-code').value = d.ifsc || '';
      if($('bank-saved')) $('bank-saved').textContent = 'Saved ‚Ä¢ tap Save to update';
    }
  }
  function saveBankCard(){
    const bankName = $('bank-name').value.trim();
    const holder = $('account-holder').value.trim();
    const accNumber = $('account-number').value.trim();
    const ifsc = $('ifsc-code').value.trim();
    if(!bankName || !holder || !accNumber || !ifsc){ alert('Please fill all fields.'); return; }
    db.collection('bankCards').doc(UID).set({
      bankName, holder, accNumber, ifsc, updatedAt: Date.now()
    }).then(()=>{
      $('bank-saved').textContent = 'Bank details saved ‚úî';
    }).catch(e=>alert(e.message));
  }

  /* =========================
     Customer Service
     ========================= */
  function sendMessage(){
    const msg = $('cs-message').value.trim();
    if(!msg) return alert('Write a message first.');
    db.collection('customerService').add({
      userId: UID, message: msg,
      status:'open', time: firebase.firestore.FieldValue.serverTimestamp()
    }).then(()=>{
      $('cs-message').value = '';
      alert('Message sent.');
    }).catch(e=>alert(e.message));
  }

  /* =========================
     Password Reset
     ========================= */
  function resetPassword(){
    const email = $('reset-email').value.trim();
    if(!email) return alert('Enter your email.');
    auth.sendPasswordResetEmail(email)
      .then(()=>alert('Password reset email sent.'))
      .catch(err=>alert(err.message));
  }

  /* =========================
     Transactions (list)
     ========================= */
  function renderTxItem(t){
    const amt = Number(t.amount||0);
    const sign = amt>=0 ? '+' : '‚Äì';
    const color = amt>=0 ? 'style="color:#16a34a;font-weight:700"' : 'style="color:#ef4444;font-weight:700"';
    const when = t.time && t.time.toDate ? t.time.toDate() : new Date();
    return `<div class="card" style="margin:8px 0">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><strong>${t.type||'transaction'}</strong><div class="muted">${when.toLocaleString()}</div></div>
        <div ${color}>${sign}‚Çπ${Math.abs(amt).toFixed(2)}</div>
      </div>
    </div>`;
  }

  function loadTransactions(){
    const list = $('transactions-list');
    list.innerHTML = 'Loading‚Ä¶';
    db.collection('transactions')
      .where('userId','==',UID).orderBy('time','desc').limit(50)
      .get().then(snap=>{
        if(snap.empty){ list.innerHTML = '<div class="muted">No transactions yet.</div>'; return; }
        let html = '';
        snap.forEach(doc=> html += renderTxItem(doc.data()));
        list.innerHTML = html;
      });
  }
  function loadHomeTransactions(){
    const list = $('home-transactions');
    db.collection('transactions')
      .where('userId','==',UID).orderBy('time','desc').limit(5)
      .onSnapshot(snap=>{
        if(snap.empty){ list.innerHTML = 'No recent activity.'; return; }
        let html = '';
        snap.forEach(doc=> html += renderTxItem(doc.data()));
        list.innerHTML = html;
      });
  }

  /* =========================
     Admin (simple)
     ========================= */
  function openAdmin(){
    const pwd = prompt('Enter admin password:');
    if(pwd!=='admin123') { alert('Wrong password'); return; }
    showSection(null,'admin'); // go to admin page

    // deposits
    db.collection('depositRequests').orderBy('time','desc')
      .onSnapshot(snap=>{
        const el = $('admin-deposits');
        if(snap.empty){ el.textContent = 'No deposit requests.'; return; }
        let html='';
        snap.forEach(doc=>{
          const d = doc.data();
          const when = d.time && d.time.toDate ? d.time.toDate().toLocaleString() : '';
          html += `<div class="card">
            <div><strong>UID:</strong> ${d.userId} ‚Ä¢ <strong>‚Çπ${Number(d.amount||0).toFixed(2)}</strong> ‚Ä¢ <span class="muted">${d.status||'pending'} ‚Ä¢ ${when}</span></div>
            <div style="margin-top:8px;display:flex;gap:8px">
              <button class="btn success" onclick="approveDeposit('${doc.id}','${d.userId}',${Number(d.amount||0)})">Approve</button>
              <button class="btn danger" onclick="declineDeposit('${doc.id}')">Decline</button>
            </div>
          </div>`;
        });
        el.innerHTML = html;
      });

    // withdrawals
    db.collection('withdrawRequests').orderBy('time','desc')
      .onSnapshot(snap=>{
        const el = $('admin-withdrawals');
        if(snap.empty){ el.textContent = 'No withdrawal requests.'; return; }
        let html='';
        snap.forEach(doc=>{
          const d = doc.data();
          const when = d.time && d.time.toDate ? d.time.toDate().toLocaleString() : '';
          html += `<div class="card">
            <div><strong>UID:</strong> ${d.userId} ‚Ä¢ <strong>‚Çπ${Number(d.amount||0).toFixed(2)}</strong> ‚Ä¢ <span class="muted">${d.status||'pending'} ‚Ä¢ ${when}</span></div>
            <div style="margin-top:8px;display:flex;gap:8px">
              <button class="btn success" onclick="approveWithdraw('${doc.id}','${d.userId}',${Number(d.amount||0)})">Approve</button>
              <button class="btn danger" onclick="declineWithdraw('${doc.id}')">Decline</button>
            </div>
          </div>`;
        });
        el.innerHTML = html;
      });
  }

  // Admin actions
  async function approveDeposit(docId, userId, amount){
    // credit wallet
    const wref = db.collection('wallets').doc(userId);
    const wdoc = await wref.get();
    const bal = wdoc.exists ? (wdoc.data().balance||0) : 0;
    await wref.set({ balance: bal + amount });
    // mark approved
    await db.collection('depositRequests').doc(docId).update({ status:'approved' });
    await db.collection('transactions').add({
      userId, amount, type:'deposit_approved', status:'completed',
      time: firebase.firestore.FieldValue.serverTimestamp()
    });
    alert('Deposit approved.');
  }
  async function declineDeposit(docId){
    await db.collection('depositRequests').doc(docId).update({ status:'declined' });
    alert('Deposit declined.');
  }
  async function approveWithdraw(docId, userId, amount){
    const wref = db.collection('wallets').doc(userId);
    const wdoc = await wref.get();
    const bal = wdoc.exists ? (wdoc.data().balance||0) : 0;
    if(bal < amount){ alert('Insufficient wallet balance'); return; }
    await wref.set({ balance: bal - amount });
    await db.collection('withdrawRequests').doc(docId).update({ status:'approved' });
    await db.collection('transactions').add({
      userId, amount:-amount, type:'withdraw_paid', status:'completed',
      time: firebase.firestore.FieldValue.serverTimestamp()
    });
    alert('Withdrawal marked as paid.');
  }
  async function declineWithdraw(docId){
    await db.collection('withdrawRequests').doc(docId).update({ status:'declined' });
    alert('Withdrawal declined.');
  }
  </script>
</body>
</html>
